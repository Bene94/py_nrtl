import os
import ctypes
import numpy as np
import time
import torch

from calc_lle import calc_LLE


import py_nrtl

def dummy():
    pass


alpha = np.array([
    [0.0, -1.39],
    [-1.39, 0.0]
])

tau = np.array([
    [0.0, 1.2],
    [1.36, 0.0]
])

alpha = np.array([
    [0.0, -1.23],
    [-1.23, 0.0]
])

tau = np.array([
    [0.0, 0.244],
    [1.337, 0.0]
])

alpha = np.array([
    [0.0, 0.1425],
    [0.1425, 0.0]
])

tau = np.array([
    [0.0000, 1.3079],
    [1.3409, 0.0000]
])

alpha_matrix = np.array([[ 
    [0.0, 0.1691],
    [0.1691, 0.0]],
    [[0.0, 0.1691],
    [0.1691, 0.0]]

])

tau_matrix = np.array([[ 
    [0.0, 1.2648],
    [1.3111, 0.0]],
    [[0.0, 1.2648],
    [1.3111, 0.0]]

])

alpha_single = [0.2023, 0.2023, 0.2023]
tau_12 = [1.0023, 1.0023, 1.0023]
tau_21 = [0.9410, 0.9410, 0.9410]


for i in range(alpha.shape[0]): 
    alpha_matrix_i = torch.tensor([[[0, alpha_single[i]],[alpha_single[i], 0]]])
    tau_matrix_i = torch.tensor([[[0, tau_12[i]],[tau_21[i], 0]]])
    if i == 0:
        alpha_matrix = alpha_matrix_i
        tau_matrix = tau_matrix_i
    else:
        alpha_matrix = torch.cat((alpha_matrix, alpha_matrix_i))
        tau_matrix = torch.cat((tau_matrix,tau_matrix_i))

alpha_matrix = alpha_matrix.to(torch.float64)
tau_matrix = tau_matrix.to(torch.float64)

alpha_matrix = torch.tensor([
        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1422],
         [0.1422, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1423],
         [0.1423, 0.0000]],

        [[0.0000, 0.1423],
         [0.1423, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1416],
         [0.1416, 0.0000]],

        [[0.0000, 0.1420],
         [0.1420, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1423],
         [0.1423, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1420],
         [0.1420, 0.0000]],

        [[0.0000, 0.1423],
         [0.1423, 0.0000]],

        [[0.0000, 0.1420],
         [0.1420, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1417],
         [0.1417, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1420],
         [0.1420, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1422],
         [0.1422, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1417],
         [0.1417, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1422],
         [0.1422, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1423],
         [0.1423, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1422],
         [0.1422, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1423],
         [0.1423, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1423],
         [0.1423, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1420],
         [0.1420, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1417],
         [0.1417, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1419],
         [0.1419, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1420],
         [0.1420, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1420],
         [0.1420, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1422],
         [0.1422, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1423],
         [0.1423, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]]], dtype=torch.float64)

alpha_matrix2 = np.array([
        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1422],
         [0.1422, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1423],
         [0.1423, 0.0000]],

        [[0.0000, 0.1423],
         [0.1423, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1416],
         [0.1416, 0.0000]],

        [[0.0000, 0.1420],
         [0.1420, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1423],
         [0.1423, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1420],
         [0.1420, 0.0000]],

        [[0.0000, 0.1423],
         [0.1423, 0.0000]],

        [[0.0000, 0.1420],
         [0.1420, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1417],
         [0.1417, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1420],
         [0.1420, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1422],
         [0.1422, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1417],
         [0.1417, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1422],
         [0.1422, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1423],
         [0.1423, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1422],
         [0.1422, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1423],
         [0.1423, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1423],
         [0.1423, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1420],
         [0.1420, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1417],
         [0.1417, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1419],
         [0.1419, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1420],
         [0.1420, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1420],
         [0.1420, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1422],
         [0.1422, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1423],
         [0.1423, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1421],
         [0.1421, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]],

        [[0.0000, 0.1425],
         [0.1425, 0.0000]],

        [[0.0000, 0.1418],
         [0.1418, 0.0000]],

        [[0.0000, 0.1424],
         [0.1424, 0.0000]]])

tau_matrix = torch.tensor([
        [[0.0000, 1.3079],
         [1.3409, 0.0000]],

        [[0.0000, 1.3079],
         [1.3409, 0.0000]],

        [[0.0000, 1.3130],
         [1.3407, 0.0000]],

        [[0.0000, 1.3111],
         [1.3437, 0.0000]],

        [[0.0000, 1.3079],
         [1.3409, 0.0000]],

        [[0.0000, 1.3111],
         [1.3437, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3130],
         [1.3407, 0.0000]],

        [[0.0000, 1.3108],
         [1.3431, 0.0000]],

        [[0.0000, 1.3117],
         [1.3388, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3130],
         [1.3407, 0.0000]],

        [[0.0000, 1.3129],
         [1.3406, 0.0000]],

        [[0.0000, 1.3117],
         [1.3388, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3113],
         [1.3440, 0.0000]],

        [[0.0000, 1.3099],
         [1.3415, 0.0000]],

        [[0.0000, 1.3129],
         [1.3406, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3102],
         [1.3420, 0.0000]],

        [[0.0000, 1.3100],
         [1.3417, 0.0000]],

        [[0.0000, 1.3111],
         [1.3437, 0.0000]],

        [[0.0000, 1.3111],
         [1.3437, 0.0000]],

        [[0.0000, 1.3146],
         [1.3426, 0.0000]],

        [[0.0000, 1.3116],
         [1.3445, 0.0000]],

        [[0.0000, 1.3079],
         [1.3409, 0.0000]],

        [[0.0000, 1.3136],
         [1.3411, 0.0000]],

        [[0.0000, 1.3104],
         [1.3424, 0.0000]],

        [[0.0000, 1.3099],
         [1.3415, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3079],
         [1.3409, 0.0000]],

        [[0.0000, 1.3111],
         [1.3437, 0.0000]],

        [[0.0000, 1.3099],
         [1.3415, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3079],
         [1.3409, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3129],
         [1.3406, 0.0000]],

        [[0.0000, 1.3099],
         [1.3414, 0.0000]],

        [[0.0000, 1.3130],
         [1.3407, 0.0000]],

        [[0.0000, 1.3121],
         [1.3393, 0.0000]],

        [[0.0000, 1.3102],
         [1.3421, 0.0000]],

        [[0.0000, 1.3120],
         [1.3392, 0.0000]],

        [[0.0000, 1.3131],
         [1.3408, 0.0000]],

        [[0.0000, 1.3134],
         [1.3412, 0.0000]],

        [[0.0000, 1.3081],
         [1.3411, 0.0000]],

        [[0.0000, 1.3118],
         [1.3390, 0.0000]],

        [[0.0000, 1.3131],
         [1.3408, 0.0000]],

        [[0.0000, 1.3099],
         [1.3414, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3105],
         [1.3426, 0.0000]],

        [[0.0000, 1.3099],
         [1.3414, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3138],
         [1.3417, 0.0000]],

        [[0.0000, 1.3117],
         [1.3388, 0.0000]],

        [[0.0000, 1.3083],
         [1.3414, 0.0000]],

        [[0.0000, 1.3088],
         [1.3420, 0.0000]],

        [[0.0000, 1.3079],
         [1.3409, 0.0000]],

        [[0.0000, 1.3105],
         [1.3426, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3102],
         [1.3420, 0.0000]],

        [[0.0000, 1.3117],
         [1.3388, 0.0000]],

        [[0.0000, 1.3111],
         [1.3437, 0.0000]],

        [[0.0000, 1.3117],
         [1.3388, 0.0000]],

        [[0.0000, 1.3082],
         [1.3412, 0.0000]],

        [[0.0000, 1.3105],
         [1.3426, 0.0000]],

        [[0.0000, 1.3083],
         [1.3414, 0.0000]],

        [[0.0000, 1.3132],
         [1.3409, 0.0000]],

        [[0.0000, 1.3117],
         [1.3389, 0.0000]],

        [[0.0000, 1.3099],
         [1.3415, 0.0000]],

        [[0.0000, 1.3091],
         [1.3424, 0.0000]],

        [[0.0000, 1.3117],
         [1.3389, 0.0000]],

        [[0.0000, 1.3090],
         [1.3422, 0.0000]],

        [[0.0000, 1.3129],
         [1.3406, 0.0000]],

        [[0.0000, 1.3079],
         [1.3409, 0.0000]],

        [[0.0000, 1.3079],
         [1.3409, 0.0000]],

        [[0.0000, 1.3129],
         [1.3406, 0.0000]],

        [[0.0000, 1.3103],
         [1.3423, 0.0000]],

        [[0.0000, 1.3079],
         [1.3409, 0.0000]],

        [[0.0000, 1.3129],
         [1.3406, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3129],
         [1.3406, 0.0000]],

        [[0.0000, 1.3129],
         [1.3406, 0.0000]],

        [[0.0000, 1.3129],
         [1.3406, 0.0000]],

        [[0.0000, 1.3122],
         [1.3395, 0.0000]],

        [[0.0000, 1.3117],
         [1.3388, 0.0000]],

        [[0.0000, 1.3134],
         [1.3412, 0.0000]],

        [[0.0000, 1.3129],
         [1.3406, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3079],
         [1.3409, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3125],
         [1.3398, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3121],
         [1.3393, 0.0000]],

        [[0.0000, 1.3133],
         [1.3410, 0.0000]],

        [[0.0000, 1.3118],
         [1.3390, 0.0000]],

        [[0.0000, 1.3086],
         [1.3418, 0.0000]],

        [[0.0000, 1.3079],
         [1.3409, 0.0000]],

        [[0.0000, 1.3131],
         [1.3408, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3117],
         [1.3388, 0.0000]],

        [[0.0000, 1.3129],
         [1.3406, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3106],
         [1.3429, 0.0000]],

        [[0.0000, 1.3130],
         [1.3407, 0.0000]],

        [[0.0000, 1.3117],
         [1.3389, 0.0000]],

        [[0.0000, 1.3100],
         [1.3418, 0.0000]],

        [[0.0000, 1.3117],
         [1.3389, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3117],
         [1.3388, 0.0000]],

        [[0.0000, 1.3099],
         [1.3414, 0.0000]],

        [[0.0000, 1.3117],
         [1.3388, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3079],
         [1.3409, 0.0000]],

        [[0.0000, 1.3129],
         [1.3406, 0.0000]],

        [[0.0000, 1.3099],
         [1.3416, 0.0000]]], dtype=torch.float64)

tau_matrix2 = np.array([
        [[0.0000, 1.3079],
         [1.3409, 0.0000]],

        [[0.0000, 1.3079],
         [1.3409, 0.0000]],

        [[0.0000, 1.3130],
         [1.3407, 0.0000]],

        [[0.0000, 1.3111],
         [1.3437, 0.0000]],

        [[0.0000, 1.3079],
         [1.3409, 0.0000]],

        [[0.0000, 1.3111],
         [1.3437, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3130],
         [1.3407, 0.0000]],

        [[0.0000, 1.3108],
         [1.3431, 0.0000]],

        [[0.0000, 1.3117],
         [1.3388, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3130],
         [1.3407, 0.0000]],

        [[0.0000, 1.3129],
         [1.3406, 0.0000]],

        [[0.0000, 1.3117],
         [1.3388, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3113],
         [1.3440, 0.0000]],

        [[0.0000, 1.3099],
         [1.3415, 0.0000]],

        [[0.0000, 1.3129],
         [1.3406, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3102],
         [1.3420, 0.0000]],

        [[0.0000, 1.3100],
         [1.3417, 0.0000]],

        [[0.0000, 1.3111],
         [1.3437, 0.0000]],

        [[0.0000, 1.3111],
         [1.3437, 0.0000]],

        [[0.0000, 1.3146],
         [1.3426, 0.0000]],

        [[0.0000, 1.3116],
         [1.3445, 0.0000]],

        [[0.0000, 1.3079],
         [1.3409, 0.0000]],

        [[0.0000, 1.3136],
         [1.3411, 0.0000]],

        [[0.0000, 1.3104],
         [1.3424, 0.0000]],

        [[0.0000, 1.3099],
         [1.3415, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3079],
         [1.3409, 0.0000]],

        [[0.0000, 1.3111],
         [1.3437, 0.0000]],

        [[0.0000, 1.3099],
         [1.3415, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3079],
         [1.3409, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3129],
         [1.3406, 0.0000]],

        [[0.0000, 1.3099],
         [1.3414, 0.0000]],

        [[0.0000, 1.3130],
         [1.3407, 0.0000]],

        [[0.0000, 1.3121],
         [1.3393, 0.0000]],

        [[0.0000, 1.3102],
         [1.3421, 0.0000]],

        [[0.0000, 1.3120],
         [1.3392, 0.0000]],

        [[0.0000, 1.3131],
         [1.3408, 0.0000]],

        [[0.0000, 1.3134],
         [1.3412, 0.0000]],

        [[0.0000, 1.3081],
         [1.3411, 0.0000]],

        [[0.0000, 1.3118],
         [1.3390, 0.0000]],

        [[0.0000, 1.3131],
         [1.3408, 0.0000]],

        [[0.0000, 1.3099],
         [1.3414, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3105],
         [1.3426, 0.0000]],

        [[0.0000, 1.3099],
         [1.3414, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3138],
         [1.3417, 0.0000]],

        [[0.0000, 1.3117],
         [1.3388, 0.0000]],

        [[0.0000, 1.3083],
         [1.3414, 0.0000]],

        [[0.0000, 1.3088],
         [1.3420, 0.0000]],

        [[0.0000, 1.3079],
         [1.3409, 0.0000]],

        [[0.0000, 1.3105],
         [1.3426, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3102],
         [1.3420, 0.0000]],

        [[0.0000, 1.3117],
         [1.3388, 0.0000]],

        [[0.0000, 1.3111],
         [1.3437, 0.0000]],

        [[0.0000, 1.3117],
         [1.3388, 0.0000]],

        [[0.0000, 1.3082],
         [1.3412, 0.0000]],

        [[0.0000, 1.3105],
         [1.3426, 0.0000]],

        [[0.0000, 1.3083],
         [1.3414, 0.0000]],

        [[0.0000, 1.3132],
         [1.3409, 0.0000]],

        [[0.0000, 1.3117],
         [1.3389, 0.0000]],

        [[0.0000, 1.3099],
         [1.3415, 0.0000]],

        [[0.0000, 1.3091],
         [1.3424, 0.0000]],

        [[0.0000, 1.3117],
         [1.3389, 0.0000]],

        [[0.0000, 1.3090],
         [1.3422, 0.0000]],

        [[0.0000, 1.3129],
         [1.3406, 0.0000]],

        [[0.0000, 1.3079],
         [1.3409, 0.0000]],

        [[0.0000, 1.3079],
         [1.3409, 0.0000]],

        [[0.0000, 1.3129],
         [1.3406, 0.0000]],

        [[0.0000, 1.3103],
         [1.3423, 0.0000]],

        [[0.0000, 1.3079],
         [1.3409, 0.0000]],

        [[0.0000, 1.3129],
         [1.3406, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3129],
         [1.3406, 0.0000]],

        [[0.0000, 1.3129],
         [1.3406, 0.0000]],

        [[0.0000, 1.3129],
         [1.3406, 0.0000]],

        [[0.0000, 1.3122],
         [1.3395, 0.0000]],

        [[0.0000, 1.3117],
         [1.3388, 0.0000]],

        [[0.0000, 1.3134],
         [1.3412, 0.0000]],

        [[0.0000, 1.3129],
         [1.3406, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3079],
         [1.3409, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3125],
         [1.3398, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3121],
         [1.3393, 0.0000]],

        [[0.0000, 1.3133],
         [1.3410, 0.0000]],

        [[0.0000, 1.3118],
         [1.3390, 0.0000]],

        [[0.0000, 1.3086],
         [1.3418, 0.0000]],

        [[0.0000, 1.3079],
         [1.3409, 0.0000]],

        [[0.0000, 1.3131],
         [1.3408, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3117],
         [1.3388, 0.0000]],

        [[0.0000, 1.3129],
         [1.3406, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3106],
         [1.3429, 0.0000]],

        [[0.0000, 1.3130],
         [1.3407, 0.0000]],

        [[0.0000, 1.3117],
         [1.3389, 0.0000]],

        [[0.0000, 1.3100],
         [1.3418, 0.0000]],

        [[0.0000, 1.3117],
         [1.3389, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3117],
         [1.3388, 0.0000]],

        [[0.0000, 1.3099],
         [1.3414, 0.0000]],

        [[0.0000, 1.3117],
         [1.3388, 0.0000]],

        [[0.0000, 1.3098],
         [1.3414, 0.0000]],

        [[0.0000, 1.3079],
         [1.3409, 0.0000]],

        [[0.0000, 1.3129],
         [1.3406, 0.0000]],

        [[0.0000, 1.3099],
         [1.3416, 0.0000]]])


#alpha = np.array([[0. , 0.23449744],
#                 [0.23449744, 0. ]])
#tau = np.array([[0. , 1.1661877 ],
#                [1.17877817, 0. ]])

#alpha = np.array([[0. , 0.2],
#                 [0.2, 0. ]])
#tau = np.array([[0. , 0.3 ],
#                [0.3, 0. ]])

z = np.array([0.5, 0.5])  # Mole fractions for the mixture
z = np.array([0.5111, 0.4889])  # Mole fractions for the mixture
x0 = np.array([0.0, 1])  # Initial guess for phase 1 mole fractions

# Define your parameters here
alphas = np.stack([alpha for _ in range(128)], axis=0)
taus = np.stack([tau for _ in range(128)], axis=0)
zs = np.stack([z for _ in range(128)], axis=0)
#z_tensor = torch.tensor(zs)
x0s = np.stack([x0 for _ in range(128)], axis=0)
#x0_tensor = torch.tensor(x0s)

print(py_nrtl.calc_lle_py(alpha, tau, z, x0, 1e-6, 100))
print(calc_LLE(alpha, tau, z, x0))
#out = py_nrtl.calc_lle_par_py(alphas, taus, zs, x0s, 1e-6, 100)
out = py_nrtl.calc_lle_par_py(alpha_matrix.detach().cpu().numpy(), tau_matrix.detach().cpu().numpy(), zs, x0s, 1e-6, 100) # 
out2 = py_nrtl.calc_lle_par_py(alpha_matrix2, tau_matrix2, zs, x0s, 1e-6, 100)
out3 = py_nrtl.calc_lle_par_py(alphas, taus, zs, x0s, 1e-6, 100)
print((out[0][0], out[1][0], out[2][0]))
print((out2[0][0], out2[1][0], out2[2][0]))
print((out3[0][0], out3[1][0], out3[2][0]))
time_start_rust = time.time()
for i in range(1000):
    x, y, beta = py_nrtl.calc_lle_py(alpha, tau, z, x0, 1e-6, 100)
print((x, y, beta))
time_end_rust = time.time()

time_start_python = time.time()
for i in range(1000):
    x, y, beta = calc_LLE(alpha, tau, z, x0)
print((x, y, beta))
time_end_python = time.time()

time_start_empty_loop = time.time()
a = 0
for i in range(1000):
    dummy()
print(a)
time_end_empty_loop = time.time()


time_start_rust_par = time.time()
x_par, y_par, beta_par = py_nrtl.calc_lle_par_py(alphas, taus, zs, x0s, 1e-6, 100)
time_end_rust_par = time.time()


print("Runtimes:")
print("Rust: ", np.round(time_end_rust - time_start_rust,3), "s")
print("Python: ", np.round(time_end_python - time_start_python,2), "s")
print("Empty Loop: ", np.round(time_end_empty_loop - time_start_empty_loop,2), "s")
print("Speedup: ", np.round((time_end_python - time_start_python)/(time_end_rust - time_start_rust),2))


print("Parallel Runtimes:")
print("Rust parallel: ", np.round(time_end_rust_par - time_start_rust_par,3), "s")
print("Speedup: ", np.round((time_end_python - time_start_python)/(time_end_rust_par - time_start_rust_par),2))
